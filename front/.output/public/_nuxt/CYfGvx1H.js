import{f as T,g as M,r as l,h as S,i as B,j as E,c as n,k as i,t as N,a as t,l as f,v as y,m as R,o as c}from"./t96BDbEU.js";const A=t("h1",{class:"text-center text-2xl mt-2"},"Активація аккаунту",-1),W={key:0,class:"text-center mt-1 mb-2"},j={key:1,class:"text-red-500 text-center mt-1 mb-2"},C={key:2,class:"mt-1 mb-2 text-green-500 text-center"},L={key:3,class:"mt-4"},$=t("h2",{class:"text-center text-xl mb-2"}," Заповніть дані для завершення реєстрації ",-1),q={class:"mb-2"},z=t("label",{for:"name",class:"block"},"Ім'я:",-1),F={class:"mb-2"},G=t("label",{for:"surname",class:"block"},"Прізвище:",-1),H={class:"mb-2"},I=t("label",{for:"phone",class:"block"},"Телефон:",-1),J={class:"mb-2"},K=t("label",{for:"picture",class:"block"},"Фото профілю (URL):",-1),O=t("button",{type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded mt-2"}," Зберегти ",-1),P={key:4,class:"text-center"},Q=t("a",{href:"/"},"Повернутися на головну",-1),X=[Q],ee={__name:"[uuid]",setup(Y){const k=T(),{$api:U}=M(),g=l(!1),p=l(!1),m=S(),w=l(!0),D=B(),a=l(null),v=l(""),h=l(""),_=l(""),x=l("");E(async()=>{var r,s,e,d;try{const u=D.params.uuid,b=await U.auth.activate(u);if(b&&[200,201].includes(b.status)&&![400,401,403,404,500].includes(b.data.status)){const o=b.data;k.saveUserData(o),p.value=!0,(!o.user.name||!o.user.surname||!o.user.phone)&&(v.value=o.user.name||"",h.value=o.user.surname||"",_.value=o.user.phone||"",x.value=o.user.picture||"",g.value=!0)}else a.value="Помилка активації.",setTimeout(()=>m.push("/"),3e3)}catch(u){a.value="Помилка активації: "+((s=(r=u.response)==null?void 0:r.data)!=null&&s.message.includes("Error:")?u.response.data.message.replace("Error: ",""):(d=(e=u.response)==null?void 0:e.data)==null?void 0:d.message),setTimeout(()=>m.push("/"),3e3)}finally{w.value=!1}});const V=async()=>{var r,s;try{let e=_.value.replace(/\D/g,"");e.startsWith("0")&&(e="38"+e),e.startsWith("380")&&(e=e.replace(/^380/,"380"));const d=await U.auth.updateUser({name:v.value,surname:h.value,phone:e,picture:x.value});if([200,201].includes(d.status)){const u=k.loadUserData();u.user=d.data[0],k.saveUserData(u),p.value=!0,g.value=!1}else a.value="Не вдалося оновити дані користувача.",setTimeout(()=>m.push("/"),3e3)}catch(e){a.value="Помилка оновлення: "+(((s=(r=e.response)==null?void 0:r.data)==null?void 0:s.message)||"Невідома помилка."),setTimeout(()=>m.push("/"),3e3)}};return(r,s)=>(c(),n("div",null,[A,w.value?(c(),n("p",W,"Активація...")):i("",!0),a.value?(c(),n("p",j,N(a.value),1)):i("",!0),p.value&&!a.value?(c(),n("p",C," Вітаємо Ваш аккаунт успішно активовано! ")):i("",!0),g.value?(c(),n("div",L,[$,t("form",{class:"w-1/2 mx-auto mb-2",onSubmit:R(V,["prevent"])},[t("div",q,[z,f(t("input",{id:"name","onUpdate:modelValue":s[0]||(s[0]=e=>v.value=e),type:"text",class:"border rounded px-2 py-1 w-full"},null,512),[[y,v.value]])]),t("div",F,[G,f(t("input",{id:"surname","onUpdate:modelValue":s[1]||(s[1]=e=>h.value=e),type:"text",class:"border rounded px-2 py-1 w-full"},null,512),[[y,h.value]])]),t("div",H,[I,f(t("input",{id:"phone","onUpdate:modelValue":s[2]||(s[2]=e=>_.value=e),type:"text",class:"border rounded px-2 py-1 w-full"},null,512),[[y,_.value]])]),t("div",J,[K,f(t("input",{id:"picture","onUpdate:modelValue":s[3]||(s[3]=e=>x.value=e),type:"text",class:"border rounded px-2 py-1 w-full"},null,512),[[y,x.value]])]),O],32)])):i("",!0),!w.value&&(a.value||p.value)?(c(),n("p",P,X)):i("",!0)]))}};export{ee as default};
